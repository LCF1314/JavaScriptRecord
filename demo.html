<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<script >
    class Stack {
        constructor() {
            this._dataStore = [];
            this._top = 0;
        }
        push(element) {
            this._dataStore[this._top++] = element;
        }
        pop(element) {
            let t = --this._top;
            return this._dataStore[t];
        }
        peek() {
            return this._dataStore[this._top - 1];
        }
        length() {
            return this._top;
        }
        clear() {
            this._top = 0;
        }
    };
    // 1 2 3 + 4 * + 5 -
    const express = '1+((2+3)*4)-5';
    // 成对
    // 第一个不能为)
    // ()中间不能为空
    function fact(express) {
        const s1 = new Stack(); // 操作符栈
        const s2 = new Stack(); // 操作数栈
        const arr = express.split('');
        console.log(arr)
        arr.forEach((i, index) => {
            if(/^[0-9]*$/.test(i)) {
                s2.push(i)
            } else if(['+', '-', '*', '/'].includes(i)) {
                if(s1.length() === 0 || s1.peek() === '(') {
                    s1.push(i)
                } else if (['*', '/'].includes(i) && ['+', '-'].includes(s1.peek())) {
                    s1.push(i)
                } else {
                    s2.push(s1.pop());
                    if(s1.length() === 0 || s1.peek() === '(') {
                        s1.push(i);
                    }
                }
            } else if (i === '(') {
                s1.push(i);
            } else if (i === ')') {
                while(s1.peek() !== '(') {
                    s2.push(s1.pop());
                }
                s1.pop();
            }
        });
        
        while(s1.length() > 0) {
            s2.push(s1.pop());
        };

        let str = ''
        while(s2.length() > 0) {
            str += ` ${s2.pop()}`;
        };
        
        return str;
    };

    console.log(fact(express))
</script>
<body>
    
</body>
</html>